Akamai SIEM Integration Ruleset:
  minRawLength: 256
  rules:
    - condition: _raw.includes("https://problems.cloudsecurity.akamaiapis.net")
      type: regex
      timestampAnchorRegex: /^/
      timestamp:
        type: auto
        length: 150
      timestampTimezone: local
      timestampEarliest: -420weeks
      timestampLatest: +1week
      maxEventBytes: 1048576
      disabled: false
      parserEnabled: false
      shouldUseDataRaw: false
      eventBreakerRegex: /^\b$/
      name: Akamai Error
      fields:
        - name: __drop
          value: "true"
    - condition: "true"
      type: json
      timestampAnchorRegex: /start/
      timestamp:
        type: auto
        length: 150
      timestampTimezone: local
      timestampEarliest: -420weeks
      timestampLatest: +1week
      maxEventBytes: 134217728
      disabled: false
      parserEnabled: false
      shouldUseDataRaw: false
      eventBreakerRegex: /[\n\r]+(?!\s)/
      name: Akamai Security Events
      fields:
  description: Event breaking rules to handle Akamai Multi-JSON responses
  lib: custom
